/var/lib/slurm/slurmd/job04937/slurm_script: line 20: module: command not found
+======================================================================================+
              Runing Script: Model/run_tests.py
+======================================================================================+
2025-03-06 00:12:46.334770: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1741219966.707256 2801829 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1741219966.813915 2801829 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-03-06 00:12:47.772184: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
mkdir -p failed for path /home/ece498_w25_20/.config/matplotlib: [Errno 13] Permission denied: '/home/ece498_w25_20'
Matplotlib created a temporary cache directory at /tmp/matplotlib-zh16rbbi because there was an issue with the default path (/home/ece498_w25_20/.config/matplotlib); it is highly recommended to set the MPLCONFIGDIR environment variable to a writable directory, in particular to speed up the import of Matplotlib and to better support multiprocessing.
I0000 00:00:1741219978.373005 2801829 gpu_device.cc:2022] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 18230 MB memory:  -> device: 0, name: NVIDIA RTX A4500, pci bus id: 0000:51:00.0, compute capability: 8.6
Num GPUs Available: 1
Generated TAF parameter combinations:
[(0.1, 0.5, 0.02), (0.1, 0.5, 0.025), (0.1, 0.5, 0.03), (0.1, 0.5, 0.035)]
*********** Starting New Cross-Validation ***********
Fold (Cross Validation) with train indices 0:7872 and test indices 7872:9920
trainX shape (After Reshape):  (3072, 4800, 1)
Model: "sequential"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃ Layer (type)                    ┃ Output Shape           ┃       Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ lstm (LSTM)                     │ (256, 4800, 100)       │        40,800 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ lstm_1 (LSTM)                   │ (256, 100)             │        80,400 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense (Dense)                   │ (256, 1)               │           101 │
└─────────────────────────────────┴────────────────────────┴───────────────┘
 Total params: 121,301 (473.83 KB)
 Trainable params: 121,301 (473.83 KB)
 Non-trainable params: 0 (0.00 B)
I0000 00:00:1741219981.937079 2801860 cuda_dnn.cc:529] Loaded cuDNN version 90300
Model states reset
12/12 - 6s - 482ms/step - loss: 0.0174
Model states reset
Epoch 1/30 --- Completed
12/12 - 3s - 280ms/step - loss: 0.0045
Model states reset
Epoch 2/30 --- Completed
12/12 - 3s - 283ms/step - loss: 0.0032
Model states reset
Epoch 3/30 --- Completed
12/12 - 3s - 283ms/step - loss: 0.0030
Model states reset
Epoch 4/30 --- Completed
12/12 - 3s - 280ms/step - loss: 0.0027
Model states reset
Epoch 5/30 --- Completed
12/12 - 3s - 280ms/step - loss: 0.0026
Model states reset
Epoch 6/30 --- Completed
12/12 - 3s - 281ms/step - loss: 0.0025
Model states reset
Epoch 7/30 --- Completed
12/12 - 3s - 284ms/step - loss: 0.0024
Model states reset
Epoch 8/30 --- Completed
12/12 - 3s - 282ms/step - loss: 0.0023
Model states reset
Epoch 9/30 --- Completed
12/12 - 3s - 285ms/step - loss: 0.0022
Model states reset
Epoch 10/30 --- Completed
12/12 - 3s - 285ms/step - loss: 0.0021
Model states reset
Epoch 11/30 --- Completed
12/12 - 3s - 287ms/step - loss: 0.0020
Model states reset
Epoch 12/30 --- Completed
12/12 - 3s - 286ms/step - loss: 0.0018
Model states reset
Epoch 13/30 --- Completed
12/12 - 3s - 286ms/step - loss: 0.0015
Model states reset
Epoch 14/30 --- Completed
12/12 - 3s - 286ms/step - loss: 0.0012
Model states reset
Epoch 15/30 --- Completed
12/12 - 3s - 287ms/step - loss: 0.0010
Model states reset
Epoch 16/30 --- Completed
12/12 - 3s - 286ms/step - loss: 9.9414e-04
Model states reset
Epoch 17/30 --- Completed
12/12 - 3s - 286ms/step - loss: 9.6788e-04
Model states reset
Epoch 18/30 --- Completed
12/12 - 3s - 285ms/step - loss: 9.4569e-04
Model states reset
Epoch 19/30 --- Completed
12/12 - 3s - 289ms/step - loss: 9.3133e-04
Model states reset
Epoch 20/30 --- Completed
12/12 - 3s - 287ms/step - loss: 9.1457e-04
Model states reset
Epoch 21/30 --- Completed
12/12 - 3s - 288ms/step - loss: 8.9932e-04
Model states reset
Epoch 22/30 --- Completed
12/12 - 3s - 287ms/step - loss: 8.8538e-04
Model states reset
Epoch 23/30 --- Completed
12/12 - 3s - 288ms/step - loss: 8.7165e-04
Model states reset
Epoch 24/30 --- Completed
12/12 - 3s - 290ms/step - loss: 8.5869e-04
Model states reset
Epoch 25/30 --- Completed
12/12 - 3s - 290ms/step - loss: 8.4625e-04
Model states reset
Epoch 26/30 --- Completed
12/12 - 3s - 291ms/step - loss: 8.3422e-04
Model states reset
Epoch 27/30 --- Completed
12/12 - 3s - 289ms/step - loss: 8.2216e-04
Model states reset
Epoch 28/30 --- Completed
12/12 - 3s - 288ms/step - loss: 8.1085e-04
Model states reset
Epoch 29/30 --- Completed
12/12 - 3s - 290ms/step - loss: 7.9860e-04
Model states reset
Epoch 30/30 --- Completed
[1m 1/12[0m [32m━[0m[37m━━━━━━━━━━━━━━━━━━━[0m [1m2s[0m 195ms/step[1m 2/12[0m [32m━━━[0m[37m━━━━━━━━━━━━━━━━━[0m [1m1s[0m 111ms/step[1m 3/12[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m0s[0m 108ms/step[1m 4/12[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m0s[0m 107ms/step[1m 5/12[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m0s[0m 106ms/step[1m 6/12[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m0s[0m 106ms/step[1m 7/12[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m0s[0m 106ms/step[1m 8/12[0m [32m━━━━━━━━━━━━━[0m[37m━━━━━━━[0m [1m0s[0m 106ms/step[1m 9/12[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m0s[0m 106ms/step[1m10/12[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m0s[0m 106ms/step[1m11/12[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m0s[0m 106ms/step[1m12/12[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 106ms/step[1m12/12[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m1s[0m 107ms/step
Model: "sequential_1"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃ Layer (type)                    ┃ Output Shape           ┃       Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ lstm_2 (LSTM)                   │ (256, 4800, 100)       │        40,800 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ lstm_3 (LSTM)                   │ (256, 4800, 100)       │        80,400 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense_1 (Dense)                 │ (256, 4800, 1)         │           101 │
└─────────────────────────────────┴────────────────────────┴───────────────┘
 Total params: 121,301 (473.83 KB)
 Trainable params: 121,301 (473.83 KB)
 Non-trainable params: 0 (0.00 B)
Model: "sequential_2"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃ Layer (type)                    ┃ Output Shape           ┃       Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ lstm_4 (LSTM)                   │ (256, 4800, 100)       │        40,800 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ lstm_5 (LSTM)                   │ (256, 4800, 100)       │        80,400 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense_2 (Dense)                 │ (256, 4800, 1)         │           101 │
└─────────────────────────────────┴────────────────────────┴───────────────┘
 Total params: 121,301 (473.83 KB)
 Trainable params: 121,301 (473.83 KB)
 Non-trainable params: 0 (0.00 B)
Future batch steps:  8
[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 180ms/step[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 190ms/step
[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 117ms/step[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 127ms/step
[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 118ms/step[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 128ms/step
[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 115ms/step[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 125ms/step
[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 118ms/step[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 128ms/step
[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 116ms/step[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 126ms/step
[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 117ms/step[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 127ms/step
[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 115ms/step[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 125ms/step
Traceback (most recent call last):
  File "/mnt/slurm_nfs/ece498_w25_20/Stock-Market-Predictor/Model/run_tests.py", line 122, in run
    model, train_data_inverted, train_end, test_end, rmse_TAFs = time_series_cross_validation(curr_dataset, model_params, forecast_horizon, initial_train_size, step_size, taf_params_list)
  File "/mnt/slurm_nfs/ece498_w25_20/Stock-Market-Predictor/Model/src/cross_validation.py", line 74, in time_series_cross_validation
    rmse_taf = calculate_rmse(adjusted_forecast[:, 0], test_data[:forecast_horizon, 0])
  File "/mnt/slurm_nfs/ece498_w25_20/Stock-Market-Predictor/Model/src/utils.py", line 5, in calculate_rmse
    return np.sqrt(mean_squared_error(true_values, predicted_values))
  File "/mnt/slurm_nfs/ece498_w25_20/LSTM_VENV_tmp__V3_10_12/LSTM_venv/lib/python3.10/site-packages/sklearn/utils/_param_validation.py", line 216, in wrapper
    return func(*args, **kwargs)
  File "/mnt/slurm_nfs/ece498_w25_20/LSTM_VENV_tmp__V3_10_12/LSTM_venv/lib/python3.10/site-packages/sklearn/metrics/_regression.py", line 565, in mean_squared_error
    _check_reg_targets_with_floating_dtype(
  File "/mnt/slurm_nfs/ece498_w25_20/LSTM_VENV_tmp__V3_10_12/LSTM_venv/lib/python3.10/site-packages/sklearn/metrics/_regression.py", line 198, in _check_reg_targets_with_floating_dtype
    y_type, y_true, y_pred, multioutput = _check_reg_targets(
  File "/mnt/slurm_nfs/ece498_w25_20/LSTM_VENV_tmp__V3_10_12/LSTM_venv/lib/python3.10/site-packages/sklearn/metrics/_regression.py", line 104, in _check_reg_targets
    check_consistent_length(y_true, y_pred)
  File "/mnt/slurm_nfs/ece498_w25_20/LSTM_VENV_tmp__V3_10_12/LSTM_venv/lib/python3.10/site-packages/sklearn/utils/validation.py", line 475, in check_consistent_length
    raise ValueError(
ValueError: Found input variables with inconsistent numbers of samples: [2048, 2000]
Forecast infered data shape:  (2048, 1)
+======================================================================================+
+======================================================================================+
ERROR! Details: 
+======================================================================================+
+======================================================================================+
+===========================================+
Runtime for: Model/run_tests.py
-----------> 00d:00h:03m:01s
+===========================================+
